"use strict";const e=require("../../common/vendor.js"),i=require("../../api.js"),h={__name:"history",setup(y){const r=e.ref(!0),s=e.ref([]),n=JSON.parse(e.index.getStorageSync("userInfo")),c=async()=>{try{const o=await e.index.request({url:i.Get_All_BrowseHistory,method:"POST",data:{User_Name:n.username}});s.value=o.data,e.index.__f__("log","at pages/history/history.vue:53",s.value)}catch{e.index.showToast({title:"加载失败，请稍后再试",icon:"none"})}finally{r.value=!1}},l=o=>{e.index.navigateTo({url:`/pages/detail/detail?id=${o}`})},_=async o=>{try{const a=await e.index.request({url:i.Delete_BrowseHistory,method:"POST",data:{User_Name:n.username,Book_ID:o}});e.index.__f__("log","at pages/history/history.vue:81",a),a.statusCode==200?(e.index.showToast({title:"删除记录成功",icon:"success"}),s.value=s.value.filter(t=>t.Book_ID!==o)):e.index.showToast({title:"删除记录失败，请稍后再试",icon:"none"})}catch{e.index.showToast({title:"网络请求失败，请检查您的网络连接",icon:"none"})}},u=async()=>{try{const o=await e.index.request({url:i.Clear_AllBrowseHistory,method:"POST",data:{User_Name:n.username}});e.index.__f__("log","at pages/history/history.vue:112",o),o.statusCode==200?(e.index.showToast({title:"清空记录成功",icon:"success"}),s.value=[]):e.index.showToast({title:"清空记录失败，请稍后再试",icon:"none"})}catch{e.index.showToast({title:"网络请求失败，请检查您的网络连接",icon:"none"})}};return e.onMounted(()=>{c()}),(o,a)=>e.e({a:r.value},r.value?{}:s.value.length===0?{}:{c:e.o(u),d:e.f(s.value,(t,x,f)=>({a:t.Img_Url,b:e.o(d=>l(t.Book_ID),t.Book_ID),c:e.t(t.Book_Name),d:e.t(t.Browse_Time),e:e.o(d=>_(t.Book_ID),t.Book_ID),f:t.Book_ID}))},{b:s.value.length===0})}},v=e._export_sfc(h,[["__scopeId","data-v-b2d018fa"]]);wx.createPage(v);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/history/history.js.map
