{"version":3,"file":"utils.js","sources":["uni_modules/lime-echart/components/l-echart/utils.js"],"sourcesContent":["// @ts-nocheck\r\n/**\n * 获取设备基础信息\n *\n * @see [uni.getDeviceInfo](https://uniapp.dcloud.net.cn/api/system/getDeviceInfo.html)\n */\nexport function getDeviceInfo() {\n\tif (uni.getDeviceInfo && uni.canIUse('getDeviceInfo')) {\n\t\treturn uni.getDeviceInfo();\n\t} else {\n\t\treturn uni.getSystemInfoSync();\n\t}\n}\n\n/**\n * 获取窗口信息\n *\n * @see [uni.getWindowInfo](https://uniapp.dcloud.net.cn/api/system/getWindowInfo.html)\n */\nexport function getWindowInfo() {\n\tif (uni.getWindowInfo && uni.canIUse('getWindowInfo')) {\n\t\treturn uni.getWindowInfo();\n\t} else {\n\t\treturn uni.getSystemInfoSync();\n\t}\n}\n\n/**\n * 获取APP基础信息\n *\n * @see [uni.getAppBaseInfo](https://uniapp.dcloud.net.cn/api/system/getAppBaseInfo.html)\n */\nexport function getAppBaseInfo() {\n\tif (uni.getAppBaseInfo && uni.canIUse('getAppBaseInfo')) {\n\t\treturn uni.getAppBaseInfo();\n\t} else {\n\t\treturn uni.getSystemInfoSync();\n\t}\n}\r\n\r\n\r\n// #ifndef APP-NVUE\r\n// 计算版本\r\nexport function compareVersion(v1, v2) {\r\n\tv1 = v1.split('.')\r\n\tv2 = v2.split('.')\r\n\tconst len = Math.max(v1.length, v2.length)\r\n\twhile (v1.length < len) {\r\n\t\tv1.push('0')\r\n\t}\r\n\twhile (v2.length < len) {\r\n\t\tv2.push('0')\r\n\t}\r\n\tfor (let i = 0; i < len; i++) {\r\n\t\tconst num1 = parseInt(v1[i], 10)\r\n\t\tconst num2 = parseInt(v2[i], 10)\r\n\r\n\t\tif (num1 > num2) {\r\n\t\t\treturn 1\r\n\t\t} else if (num1 < num2) {\r\n\t\t\treturn -1\r\n\t\t}\r\n\t}\r\n\treturn 0\r\n}\r\n// const systemInfo = uni.getSystemInfoSync();\r\n\r\nfunction gte(version) {\r\n\t// 截止 2023-03-22 mac pc小程序不支持 canvas 2d\r\n\t// let {\r\n\t// \tSDKVersion,\r\n\t// \tplatform\r\n\t// } = systemInfo;\r\n\tconst { platform } = getDeviceInfo();\r\n\tlet { SDKVersion } = getAppBaseInfo();\r\n\t// #ifdef MP-ALIPAY\r\n\tSDKVersion = my.SDKVersion\r\n\t// #endif\r\n\t// #ifdef MP-WEIXIN\r\n\treturn platform !== 'mac' && compareVersion(SDKVersion, version) >= 0;\r\n\t// #endif\r\n\treturn compareVersion(SDKVersion, version) >= 0;\r\n}\r\n\r\n\r\nexport function canIUseCanvas2d() {\r\n\t// #ifdef MP-WEIXIN\r\n\treturn gte('2.9.0');\r\n\t// #endif\r\n\t// #ifdef MP-ALIPAY\r\n\treturn gte('2.7.0');\r\n\t// #endif\r\n\t// #ifdef MP-TOUTIAO\r\n\treturn gte('1.78.0');\r\n\t// #endif\r\n\treturn false\r\n}\r\n\r\nexport function convertTouchesToArray(touches) {\r\n\t// 如果 touches 是一个数组，则直接返回它\r\n\tif (Array.isArray(touches)) {\r\n\t\treturn touches;\r\n\t}\r\n\t// 如果touches是一个对象，则转换为数组\r\n\tif (typeof touches === 'object' && touches !== null) {\r\n\t\treturn Object.values(touches);\r\n\t}\r\n\t// 对于其他类型，直接返回它\r\n\treturn touches;\r\n}\r\n\r\nexport function wrapTouch(event) {\r\n\tevent.touches = convertTouchesToArray(event.touches)\r\n\tfor (let i = 0; i < event.touches.length; ++i) {\r\n\t\tconst touch = event.touches[i];\r\n\t\ttouch.offsetX = touch.x;\r\n\t\ttouch.offsetY = touch.y;\r\n\t}\r\n\treturn event;\r\n}\r\n// export const devicePixelRatio = uni.getSystemInfoSync().pixelRatio\r\nexport const devicePixelRatio = getWindowInfo().pixelRatio;\r\n// #endif\r\n// #ifdef APP-NVUE\r\nexport function base64ToPath(base64) {\r\n\treturn new Promise((resolve, reject) => {\r\n\t\tconst [, format, bodyData] = /data:image\\/(\\w+);base64,(.*)/.exec(base64) || [];\r\n\t\tconst bitmap = new plus.nativeObj.Bitmap('bitmap' + Date.now())\r\n\t\tbitmap.loadBase64Data(base64, () => {\r\n\t\t\tif (!format) {\r\n\t\t\t\treject(new Error('ERROR_BASE64SRC_PARSE'))\r\n\t\t\t}\r\n\t\t\tconst time = new Date().getTime();\r\n\t\t\tconst filePath = `_doc/uniapp_temp/${time}.${format}`\r\n\r\n\t\t\tbitmap.save(filePath, {},\r\n\t\t\t\t() => {\r\n\t\t\t\t\tbitmap.clear()\r\n\t\t\t\t\tresolve(filePath)\r\n\t\t\t\t},\r\n\t\t\t\t(error) => {\r\n\t\t\t\t\tbitmap.clear()\r\n\t\t\t\t\tconsole.error(`${JSON.stringify(error)}`)\r\n\t\t\t\t\treject(error)\r\n\t\t\t\t})\r\n\t\t}, (error) => {\r\n\t\t\tbitmap.clear()\r\n\t\t\tconsole.error(`${JSON.stringify(error)}`)\r\n\t\t\treject(error)\r\n\t\t})\r\n\t})\r\n}\r\n// #endif\r\n\r\n\r\nexport function sleep(time) {\r\n\treturn new Promise((resolve) => {\r\n\t\tsetTimeout(() => {\r\n\t\t\tresolve(true)\r\n\t\t}, time)\r\n\t})\r\n}\r\n\r\n\r\nexport function getRect(selector, options = {}) {\r\n\tconst typeDefault = 'boundingClientRect'\r\n\tconst {\r\n\t\tcontext,\r\n\t\ttype = typeDefault\r\n\t} = options\r\n\treturn new Promise((resolve, reject) => {\r\n\t\tconst dom = uni.createSelectorQuery().in(context).select(selector);\r\n\t\tconst result = (rect) => {\r\n\t\t\tif (rect) {\r\n\t\t\t\tresolve(rect)\r\n\t\t\t} else {\r\n\t\t\t\treject()\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (type == typeDefault) {\r\n\t\t\tdom[type](result).exec()\r\n\t\t} else {\r\n\t\t\tdom[type]({\r\n\t\t\t\tnode: true,\r\n\t\t\t\tsize: true,\r\n\t\t\t\trect: true\r\n\t\t\t}, result).exec()\r\n\t\t}\r\n\t});\r\n};"],"names":["getDeviceInfo","uni","getWindowInfo","getAppBaseInfo","compareVersion","v1","v2","len","i","num1","num2","gte","version","platform","SDKVersion","canIUseCanvas2d","convertTouchesToArray","touches","wrapTouch","event","touch","devicePixelRatio","sleep","time","resolve","getRect","selector","options","typeDefault","context","type","reject","dom","result","rect"],"mappings":"6DAMO,SAASA,GAAgB,CAC/B,OAAIC,EAAG,MAAC,eAAiBA,EAAG,MAAC,QAAQ,eAAe,EAC5CA,EAAAA,MAAI,gBAEJA,EAAAA,MAAI,mBAEb,CAOO,SAASC,GAAgB,CAC/B,OAAID,EAAG,MAAC,eAAiBA,EAAG,MAAC,QAAQ,eAAe,EAC5CA,EAAAA,MAAI,gBAEJA,EAAAA,MAAI,mBAEb,CAOO,SAASE,GAAiB,CAChC,OAAIF,EAAG,MAAC,gBAAkBA,EAAG,MAAC,QAAQ,gBAAgB,EAC9CA,EAAAA,MAAI,iBAEJA,EAAAA,MAAI,mBAEb,CAKO,SAASG,EAAeC,EAAIC,EAAI,CACtCD,EAAKA,EAAG,MAAM,GAAG,EACjBC,EAAKA,EAAG,MAAM,GAAG,EACjB,MAAMC,EAAM,KAAK,IAAIF,EAAG,OAAQC,EAAG,MAAM,EACzC,KAAOD,EAAG,OAASE,GAClBF,EAAG,KAAK,GAAG,EAEZ,KAAOC,EAAG,OAASC,GAClBD,EAAG,KAAK,GAAG,EAEZ,QAASE,EAAI,EAAGA,EAAID,EAAKC,IAAK,CAC7B,MAAMC,EAAO,SAASJ,EAAGG,CAAC,EAAG,EAAE,EACzBE,EAAO,SAASJ,EAAGE,CAAC,EAAG,EAAE,EAE/B,GAAIC,EAAOC,EACV,MAAO,GACD,GAAID,EAAOC,EACjB,MAAO,EAER,CACD,MAAO,EACR,CAGA,SAASC,EAAIC,EAAS,CAMrB,KAAM,CAAE,SAAAC,GAAab,IACrB,GAAI,CAAE,WAAAc,GAAeX,IAKrB,OAAOU,IAAa,OAAST,EAAeU,EAAYF,CAAO,GAAK,CAGrE,CAGO,SAASG,GAAkB,CAEjC,OAAOJ,EAAI,OAAO,CASnB,CAEO,SAASK,EAAsBC,EAAS,CAE9C,OAAI,MAAM,QAAQA,CAAO,EACjBA,EAGJ,OAAOA,GAAY,UAAYA,IAAY,KACvC,OAAO,OAAOA,CAAO,EAGtBA,CACR,CAEO,SAASC,EAAUC,EAAO,CAChCA,EAAM,QAAUH,EAAsBG,EAAM,OAAO,EACnD,QAASX,EAAI,EAAGA,EAAIW,EAAM,QAAQ,OAAQ,EAAEX,EAAG,CAC9C,MAAMY,EAAQD,EAAM,QAAQX,CAAC,EAC7BY,EAAM,QAAUA,EAAM,EACtBA,EAAM,QAAUA,EAAM,CACtB,CACD,OAAOD,CACR,CAEY,MAACE,EAAmBnB,EAAa,EAAG,WAkCzC,SAASoB,EAAMC,EAAM,CAC3B,OAAO,IAAI,QAASC,GAAY,CAC/B,WAAW,IAAM,CAChBA,EAAQ,EAAI,CACZ,EAAED,CAAI,CACT,CAAE,CACF,CAGO,SAASE,EAAQC,EAAUC,EAAU,GAAI,CAC/C,MAAMC,EAAc,qBACd,CACL,QAAAC,EACA,KAAAC,EAAOF,CACT,EAAKD,EACJ,OAAO,IAAI,QAAQ,CAACH,EAASO,IAAW,CACvC,MAAMC,EAAM/B,EAAG,MAAC,oBAAqB,EAAC,GAAG4B,CAAO,EAAE,OAAOH,CAAQ,EAC3DO,EAAUC,GAAS,CACpBA,EACHV,EAAQU,CAAI,EAEZH,EAAQ,CAET,EACGD,GAAQF,EACXI,EAAIF,CAAI,EAAEG,CAAM,EAAE,KAAM,EAExBD,EAAIF,CAAI,EAAE,CACT,KAAM,GACN,KAAM,GACN,KAAM,EACV,EAAMG,CAAM,EAAE,KAAM,CAEpB,CAAE,CACF"}