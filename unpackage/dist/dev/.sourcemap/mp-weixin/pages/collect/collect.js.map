{"version":3,"file":"collect.js","sources":["pages/collect/collect.vue","../../HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvY29sbGVjdC9jb2xsZWN0LnZ1ZQ"],"sourcesContent":["<template>\r\n\t<view class=\"collect-page\">\r\n\t\t<view v-if=\"loading\" class=\"loading\">\r\n\t\t\t<text>加载中...</text>\r\n\t\t</view>\r\n\t\t<view v-else-if=\"collections.length === 0\" class=\"empty\">\r\n\t\t\t<text>暂无收藏记录</text>\r\n\t\t</view>\r\n\t\t<view v-else class=\"collections\">\r\n\t\t\t<view class=\"collection-list\">\r\n\t\t\t\t<view v-for=\"item in collections\" :key=\"item.Book_ID\" class=\"collection-item\">\r\n\t\t\t\t\t<view class=\"cover\" @click=\"viewItem(item.Book_ID)\">\r\n\t\t\t\t\t\t<image :src=\"item.Img_Url\" class=\"cover-image\"></image>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"info\">\r\n\t\t\t\t\t\t<p> <text class=\"book-name\">{{ item.Book_Name }}</text></p>\r\n\t\t\t\t\t\t<text class=\"collect-time\">{{ item.Collect_Time }}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"action\">\r\n\t\t\t\t\t\t<button @click=\"removeFromCollection(item.Book_ID)\" class=\"remove-btn\">取消</button>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script setup>\r\n\timport { GET_USER_COLLECT_BOOK, UNCOLLECT_BOOK } from '@/api'; \r\n\timport {\r\n\t\tref,\r\n\t\tonMounted\r\n\t} from 'vue';\r\n\r\n\tconst loading = ref(true);\r\n\tconst collections = ref([]);\r\n\tconst user = JSON.parse(uni.getStorageSync('userInfo'));\r\n\r\n\tconst fetchCollections = async () => {\r\n\t\ttry {\r\n\t\t\tconst response = await uni.request({\r\n\t\t\t\turl: GET_USER_COLLECT_BOOK,\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tUser_Name: user.username,\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tcollections.value = response.data;\r\n\t\t} catch (error) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '加载失败，请稍后再试',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t});\r\n\t\t} finally {\r\n\t\t\tloading.value = false;\r\n\t\t}\r\n\t};\r\n\r\n\tconst viewItem = (id) => {\r\n\t\t// 这里可以根据id导航到详细页面\r\n\t\tuni.navigateTo({\r\n\t\t\turl: `/pages/detail/detail?id=${id}`\r\n\t\t});\r\n\t};\r\n\r\n\tconst removeFromCollection = async (bookId) => {\r\n\t\ttry {\r\n\t\t\tconst response = await uni.request({\r\n\t\t\t\turl: UNCOLLECT_BOOK,\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tUser_Name: user.username,\r\n\t\t\t\t\tBook_ID: bookId\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tconsole.log(response);\r\n\t\t\tif (response.statusCode == 200) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '取消收藏成功',\r\n\t\t\t\t\ticon: 'success'\r\n\t\t\t\t});\r\n\t\t\t\t// 更新本地数据\r\n\t\t\t\tcollections.value = collections.value.filter(item => item.Book_ID !== bookId);\r\n\t\t\t} else {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '取消收藏失败，请稍后再试',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '网络请求失败，请检查您的网络连接',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\tonMounted(() => {\r\n\t\tfetchCollections();\r\n\t});\r\n</script>\r\n\r\n<style scoped>\r\n\t.collect-page {\r\n\t\tpadding: 20px;\r\n\t\tbackground-color: #f5f5f5;\r\n\t\tfont-family: 'Arial', sans-serif;\r\n\t}\r\n\r\n\t.loading,\r\n\t.empty {\r\n\t\ttext-align: center;\r\n\t\tpadding: 20px;\r\n\t\tcolor: #999;\r\n\t\tfont-size: 16px;\r\n\t}\r\n\r\n\t.collection-list {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tgap: 20px;\r\n\t}\r\n\r\n\t.collection-item {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tbackground-color: #fff;\r\n\t\tpadding: 15px;\r\n\t\tborder-radius: 10px;\r\n\t\tbox-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);\r\n\t\ttransition: transform 0.2s;\r\n\t}\r\n\r\n\t.collection-item:hover {\r\n\t\ttransform: translateY(-5px);\r\n\t}\r\n\r\n\t.cover {\r\n\t\tflex: 1;\r\n\t\tcursor: pointer;\r\n\t}\r\n\r\n\t.cover-image {\r\n\t\twidth: 60px;\r\n\t\theight: 90px;\r\n\t\tborder-radius: 5px;\r\n\t\tobject-fit: cover;\r\n\t}\r\n\r\n\t.info {\r\n\t\tflex: 2;\r\n\t\tpadding-left: 10px;\r\n\t}\r\n\r\n\t.book-name {\r\n\t\tfont-size: 18px;\r\n\t\tcolor: #333;\r\n\t\tfont-weight: bold;\r\n\t\tmargin: 0;\r\n\t}\r\n\r\n\t.collect-time {\r\n\t\tfont-size: 14px;\r\n\t\tcolor: #666;\r\n\t\tmargin-top: 5px;\r\n\t}\r\n\r\n\t.action {\r\n\t\tflex: 1;\r\n\t\ttext-align: right;\r\n\t}\r\n\r\n\t.remove-btn {\r\n\t\tbackground-color: #ff4d4f;\r\n\t\tcolor: white;\r\n\t\tborder: none;\r\n\t\tpadding: 8px 15px;\r\n\t\tborder-radius: 5px;\r\n\t\tcursor: pointer;\r\n\t\tfont-size: 14px;\r\n\t\ttransition: background-color 0.3s;\r\n\t\tbox-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);\r\n\t}\r\n\r\n\t.remove-btn:hover {\r\n\t\tbackground-color: #e53935;\r\n\t\tbox-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);\r\n\t}\r\n</style>","import MiniProgramPage from 'E:/uniapp工作空间/Science _fiction/pages/collect/collect.vue'\nwx.createPage(MiniProgramPage)"],"names":["loading","ref","collections","user","uni","fetchCollections","response","GET_USER_COLLECT_BOOK","viewItem","id","removeFromCollection","bookId","UNCOLLECT_BOOK","item","onMounted","MiniProgramPage"],"mappings":"8GAkCC,MAAMA,EAAUC,MAAI,EAAI,EAClBC,EAAcD,MAAI,CAAA,CAAE,EACpBE,EAAO,KAAK,MAAMC,EAAG,MAAC,eAAe,UAAU,CAAC,EAEhDC,EAAmB,SAAY,CACpC,GAAI,CACH,MAAMC,EAAW,MAAMF,EAAG,MAAC,QAAQ,CAClC,IAAKG,EAAqB,sBAC1B,OAAQ,OACR,KAAM,CACL,UAAWJ,EAAK,QAChB,CACL,CAAI,EACDD,EAAY,MAAQI,EAAS,IAC7B,MAAe,CACfF,EAAAA,MAAI,UAAU,CACb,MAAO,aACP,KAAM,MACV,CAAI,CACJ,QAAY,CACTJ,EAAQ,MAAQ,EAChB,CACH,EAEOQ,EAAYC,GAAO,CAExBL,EAAAA,MAAI,WAAW,CACd,IAAK,2BAA2BK,CAAE,EACrC,CAAG,CACH,EAEOC,EAAuB,MAAOC,GAAW,CAC9C,GAAI,CACH,MAAML,EAAW,MAAMF,EAAG,MAAC,QAAQ,CAClC,IAAKQ,EAAc,eACnB,OAAQ,OACR,KAAM,CACL,UAAWT,EAAK,SAChB,QAASQ,CACT,CACL,CAAI,EACDP,EAAAA,MAAY,MAAA,MAAA,kCAAAE,CAAQ,EAChBA,EAAS,YAAc,KAC1BF,EAAAA,MAAI,UAAU,CACb,MAAO,SACP,KAAM,SACX,CAAK,EAEDF,EAAY,MAAQA,EAAY,MAAM,OAAOW,GAAQA,EAAK,UAAYF,CAAM,GAE5EP,EAAAA,MAAI,UAAU,CACb,MAAO,eACP,KAAM,MACX,CAAK,CAEF,MAAe,CACfA,EAAAA,MAAI,UAAU,CACb,MAAO,mBACP,KAAM,MACV,CAAI,CACD,CACH,EAECU,OAAAA,EAAAA,UAAU,IAAM,CACfT,GACF,CAAE,0SClGF,GAAG,WAAWU,CAAe"}