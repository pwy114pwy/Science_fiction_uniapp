{"version":3,"file":"profile.js","sources":["pages/profile/profile.vue","../../HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvcHJvZmlsZS9wcm9maWxlLnZ1ZQ"],"sourcesContent":["<template>\r\n\t<view>\r\n\t\t<!-- 修改信息部分 -->\r\n\t\t<view class=\"edit_info\">\r\n\t\t\t<view class=\"info-label\" @click=\"toggleInfo\">\r\n\t\t\t\t<uni-icons type=\"down\" size=\"30\" v-if=\"isInfoCollapsed\"></uni-icons>\r\n\t\t\t\t<uni-icons type=\"up\" size=\"30\" v-else></uni-icons>\r\n\t\t\t\t{{ isInfoCollapsed ? '修改个人信息' : '个人信息：' }}\r\n\t\t\t</view>\r\n\r\n\t\t\t<view v-show=\"!isInfoCollapsed\" class=\"input-btn-container\">\r\n\t\t\t\t<view style=\"display: flex; \" class=\"\">\r\n\t\t\t\t\t<span style=\"width: 47px;padding-top: 10px;\">昵称:</span>\r\n\t\t\t\t\t<input v-model=\"nickname\" type=\"text\" :disabled=\"isdisabled\" class=\"nickname-input\" />\r\n\t\t\t\t</view>\r\n\t\t\t\t<view style=\"display: flex; \" class=\"\">\r\n\t\t\t\t\t<span style=\"width: 47px;padding-top: 10px;\">邮箱:</span>\r\n\t\t\t\t\t<input v-model=\"email\" type=\"text\" :disabled=\"isdisabled\" class=\"nickname-input\" />\r\n\t\t\t\t</view>\r\n\r\n\r\n\t\t\t\t<view class=\"btn-container\" v-if=\"isdisabled\">\r\n\t\t\t\t\t<button class=\"btn-edit\" @click=\"change_info\">修改信息</button>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"btn-container\" v-else>\r\n\t\t\t\t\t<view class=\"\" style=\"display: flex;\">\r\n\t\t\t\t\t\t<button class=\"btn-confirm\" @click=\"confirm_change\">确定</button>\r\n\t\t\t\t\t\t<button class=\"btn-cancel\" @click=\"cancel_change\">取消</button>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- 修改密码部分 -->\r\n\t\t<view class=\"edit_password\">\r\n\t\t\t<view class=\"password-label\" @click=\"togglePassword\">\r\n\t\t\t\t<uni-icons type=\"down\" size=\"30\" v-if=\"isPasswordCollapsed\"></uni-icons>\r\n\t\t\t\t<uni-icons type=\"up\" size=\"30\" v-else></uni-icons>\r\n\t\t\t\t{{ isPasswordCollapsed ? '修改密码' : '修改密码：' }}\r\n\t\t\t</view>\r\n\r\n\t\t\t<view v-show=\"!isPasswordCollapsed\" class=\"input-btn-container\">\r\n\t\t\t\t<input v-model=\"oldPassword\" type=\"password\" placeholder=\"请输入原密码\" class=\"password-input\" />\r\n\r\n\t\t\t\t<input v-model=\"newPassword\" type=\"password\" placeholder=\"请输入新密码\" class=\"password-input\" />\r\n\r\n\t\t\t\t<input v-model=\"confirmPassword\" type=\"password\" placeholder=\"确认新密码\" class=\"password-input\" />\r\n\t\t\t</view>\r\n\r\n\t\t\t<view v-show=\"!isPasswordCollapsed\" class=\"btn-container\">\r\n\t\t\t\t<button class=\"btn-confirm\" @click=\"confirm_password_change\">确认修改</button>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script setup>\r\n\timport {\r\n\t\tref\r\n\t} from 'vue';\r\n\timport {Change_Userinfo,Get_Userinfo,Change_Password} from '@/api'\r\n\tlet userinfo = JSON.parse(uni.getStorageSync('userInfo'))\r\n\tlet nickname = ref(userinfo.nickname)\r\n\tlet email = ref(userinfo.email)\r\n\tlet oldPassword = ref('')\r\n\tlet newPassword = ref('')\r\n\tlet confirmPassword = ref('')\r\n\tlet isdisabled = ref('true')\r\n\tlet username = userinfo.username\r\n\r\n\t// 控制折叠状态\r\n\tlet isInfoCollapsed = ref(true)\r\n\tlet isPasswordCollapsed = ref(true)\r\n\r\n\t// 修改昵称相关函数\r\n\tfunction change_info() {\r\n\t\tisdisabled.value = false;\r\n\t}\r\n\r\n\tasync function confirm_change() {\r\n\t\tisdisabled.value = true;\r\n\t\ttry {\r\n\t\t\tconst response = await uni.request({\r\n\t\t\t\turl: Change_Userinfo,\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tusername: username,\r\n\t\t\t\t\tnew_nickname: nickname.value,\r\n\t\t\t\t\tnew_email: email.value,\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tif (response.statusCode == 200) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '修改成功',\r\n\t\t\t\t\ticon: \"success\",\r\n\t\t\t\t\tduration: 2000\r\n\t\t\t\t});\r\n\t\t\t\tconst response1 = await uni.request({\r\n\t\t\t\t\turl: Get_Userinfo,\r\n\t\t\t\t\tmethod: 'GET',\r\n\t\t\t\t\theader: {\r\n\t\t\t\t\t\tAuthorization: `Bearer ${uni.getStorageSync('token')}`\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\tuni.setStorageSync('userInfo', JSON.stringify(response1.data.userInfo));\r\n\t\t\t\tconsole.log(response1);\r\n\t\t\t}\r\n\t\t} catch {\r\n\t\t\tconsole.log('请求失败');\r\n\t\t}\r\n\t}\r\n\r\n\tfunction cancel_change() {\r\n\t\tisdisabled.value = true;\r\n\t\tnickname.value = userinfo.nickname\r\n\t\temail.value = userinfo.email\r\n\t}\r\n\r\n\t// 修改密码相关函数\r\n\tasync function confirm_password_change() {\r\n\t\tif (newPassword.value !== confirmPassword.value) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '新密码与确认密码不一致',\r\n\t\t\t\ticon: 'none',\r\n\t\t\t\tduration: 2000\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\t// 向服务器验证原密码并更新新密码\r\n\t\t\tconst response = await uni.request({\r\n\t\t\t\turl: Change_Password,\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tusername: username,\r\n\t\t\t\t\told_password: oldPassword.value,\r\n\t\t\t\t\tnew_password: newPassword.value\r\n\t\t\t\t},\r\n\t\t\t\theader: {\r\n\t\t\t\t\tAuthorization: `Bearer ${uni.getStorageSync('token')}`\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tconsole.log(response);\r\n\r\n\t\t\tif (response.statusCode == 200) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '密码修改成功',\r\n\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\tduration: 2000\r\n\t\t\t\t});\r\n\t\t\t\t// 重置密码输入框\r\n\t\t\t\toldPassword.value = '';\r\n\t\t\t\tnewPassword.value = '';\r\n\t\t\t\tconfirmPassword.value = '';\r\n\t\t\t} else {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '原密码错误',\r\n\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\tduration: 2000\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t} catch {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '请求失败，请稍后再试',\r\n\t\t\t\ticon: 'none',\r\n\t\t\t\tduration: 2000\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\t// 切换昵称模块展开/折叠\r\n\tfunction toggleInfo() {\r\n\t\tisInfoCollapsed.value = !isInfoCollapsed.value;\r\n\t}\r\n\r\n\t// 切换密码模块展开/折叠\r\n\tfunction togglePassword() {\r\n\t\tisPasswordCollapsed.value = !isPasswordCollapsed.value;\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n\t/* 样式部分 */\r\n\t.edit_info,\r\n\t.edit_password {\r\n\t\tmargin-top: 10px;\r\n\t\twidth: 100%;\r\n\t\tpadding: 20px;\r\n\t\tbackground-color: #f7f7f7;\r\n\t\tborder-radius: 10px;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: flex-start;\r\n\t\tbox-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);\r\n\t\tmargin-bottom: 20px;\r\n\t}\r\n\r\n\t.info-label,\r\n\t.password-label {\r\n\t\tfont-size: 18px;\r\n\t\tcolor: #333;\r\n\t\tmargin-bottom: 10px;\r\n\t\tcursor: pointer;\r\n\t}\r\n\r\n\t.input-btn-container {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\twidth: 100%;\r\n\t\tmax-width: 500px;\r\n\t\tflex-direction: column;\r\n\t}\r\n\r\n\t.nickname-input,\r\n\t.password-input {\r\n\t\twidth: 300px;\r\n\t\tpadding: 10px;\r\n\t\t// padding-left: 0;\r\n\t\tmargin-right: 50px;\r\n\t\tfont-size: 15px;\r\n\t\tborder: 1px solid #ddd;\r\n\t\tborder-radius: 8px;\r\n\t\toutline: none;\r\n\t\tbackground-color: #fff;\r\n\t\tbox-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);\r\n\t\ttransition: all 0.3s ease;\r\n\t\tmargin-bottom: 10px;\r\n\r\n\t\t&:focus {\r\n\t\t\tborder-color: #4a90e2;\r\n\t\t\tbox-shadow: 0 0 5px rgba(74, 144, 226, 0.6);\r\n\t\t}\r\n\t}\r\n\r\n\t.btn-container {\r\n\t\twidth: 100%;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: flex-stat;\r\n\t\tgap: 10px;\r\n\t\tmargin-top: 10px;\r\n\t\tmargin-right: 30px;\r\n\t}\r\n\r\n\t/* 按钮样式 */\r\n\t.btn-confirm {\r\n\t\tpadding: 10px 20px;\r\n\t\tfont-size: 16px;\r\n\t\tcolor: white;\r\n\t\tbackground-color: #28a745;\r\n\t\tborder: none;\r\n\t\tborder-radius: 5px;\r\n\t\tcursor: pointer;\r\n\t\ttransition: background-color 0.3s;\r\n\t\tmargin-left: 120px;\r\n\t\t\r\n\t\t&:hover {\r\n\t\t\tbackground-color: #218838;\r\n\t\t}\r\n\t}\r\n\r\n\t.btn-cancel {\r\n\t\tmargin-left: 10px;\r\n\t\tpadding: 10px 20px;\r\n\t\t// margin-right: 30px;\r\n\t\tfont-size: 16px;\r\n\t\tcolor: white;\r\n\t\tbackground-color: #dc3545;\r\n\t\tborder: none;\r\n\t\tborder-radius: 5px;\r\n\t\tcursor: pointer;\r\n\t\ttransition: background-color 0.3s;\r\n\r\n\t\t&:hover {\r\n\t\t\tbackground-color: #c82333;\r\n\t\t}\r\n\t}\r\n\r\n\t/* 修改信息按钮 */\r\n\t.btn-edit {\r\n\t\tpadding: 10px 30px;\r\n\t\t// margin-right: 25px;\r\n\t\tfont-size: 15px;\r\n\t\tcolor: white;\r\n\t\tbackground-color: #007BFF;\r\n\t\tborder: none;\r\n\t\tborder-radius: 5px;\r\n\t\tcursor: pointer;\r\n\t\ttransition: background-color 0.3s;\r\n\r\n\t\t&:hover {\r\n\t\t\tbackground-color: #0056b3;\r\n\t\t}\r\n\t}\r\n</style>","import MiniProgramPage from 'E:/uniapp工作空间/Science _fiction/pages/profile/profile.vue'\nwx.createPage(MiniProgramPage)"],"names":["userinfo","uni","nickname","ref","email","oldPassword","newPassword","confirmPassword","isdisabled","username","isInfoCollapsed","isPasswordCollapsed","change_info","confirm_change","Change_Userinfo","response1","Get_Userinfo","cancel_change","confirm_password_change","response","Change_Password","toggleInfo","togglePassword","MiniProgramPage"],"mappings":"mPA8DC,IAAIA,EAAW,KAAK,MAAMC,EAAAA,MAAI,eAAe,UAAU,CAAC,EACpDC,EAAWC,EAAAA,IAAIH,EAAS,QAAQ,EAChCI,EAAQD,EAAAA,IAAIH,EAAS,KAAK,EAC1BK,EAAcF,EAAG,IAAC,EAAE,EACpBG,EAAcH,EAAG,IAAC,EAAE,EACpBI,EAAkBJ,EAAG,IAAC,EAAE,EACxBK,EAAaL,EAAG,IAAC,MAAM,EACvBM,EAAWT,EAAS,SAGpBU,EAAkBP,EAAG,IAAC,EAAI,EAC1BQ,EAAsBR,EAAG,IAAC,EAAI,EAGlC,SAASS,GAAc,CACtBJ,EAAW,MAAQ,EACnB,CAED,eAAeK,GAAiB,CAC/BL,EAAW,MAAQ,GACnB,GAAI,CAUH,IATiB,MAAMP,EAAG,MAAC,QAAQ,CAClC,IAAKa,EAAe,gBACpB,OAAQ,OACR,KAAM,CACL,SAAUL,EACV,aAAcP,EAAS,MACvB,UAAWE,EAAM,KACjB,CACL,CAAI,GACY,YAAc,IAAK,CAC/BH,EAAAA,MAAI,UAAU,CACb,MAAO,OACP,KAAM,UACN,SAAU,GACf,CAAK,EACD,MAAMc,EAAY,MAAMd,EAAG,MAAC,QAAQ,CACnC,IAAKe,EAAY,aACjB,OAAQ,MACR,OAAQ,CACP,cAAe,UAAUf,EAAAA,MAAI,eAAe,OAAO,CAAC,EACpD,CACN,CAAK,EACDA,QAAI,eAAe,WAAY,KAAK,UAAUc,EAAU,KAAK,QAAQ,CAAC,EACtEd,EAAAA,MAAA,MAAA,MAAA,mCAAYc,CAAS,CACrB,CACJ,MAAU,CACPd,EAAAA,MAAA,MAAA,MAAA,mCAAY,MAAM,CAClB,CACD,CAED,SAASgB,GAAgB,CACxBT,EAAW,MAAQ,GACnBN,EAAS,MAAQF,EAAS,SAC1BI,EAAM,MAAQJ,EAAS,KACvB,CAGD,eAAekB,GAA0B,CACxC,GAAIZ,EAAY,QAAUC,EAAgB,MAAO,CAChDN,EAAAA,MAAI,UAAU,CACb,MAAO,cACP,KAAM,OACN,SAAU,GACd,CAAI,EACD,MACA,CAED,GAAI,CAEH,MAAMkB,EAAW,MAAMlB,EAAG,MAAC,QAAQ,CAClC,IAAKmB,EAAe,gBACpB,OAAQ,OACR,KAAM,CACL,SAAUX,EACV,aAAcJ,EAAY,MAC1B,aAAcC,EAAY,KAC1B,EACD,OAAQ,CACP,cAAe,UAAUL,EAAAA,MAAI,eAAe,OAAO,CAAC,EACpD,CACL,CAAI,EACDA,EAAAA,MAAY,MAAA,MAAA,mCAAAkB,CAAQ,EAEhBA,EAAS,YAAc,KAC1BlB,EAAAA,MAAI,UAAU,CACb,MAAO,SACP,KAAM,UACN,SAAU,GACf,CAAK,EAEDI,EAAY,MAAQ,GACpBC,EAAY,MAAQ,GACpBC,EAAgB,MAAQ,IAExBN,EAAAA,MAAI,UAAU,CACb,MAAO,QACP,KAAM,OACN,SAAU,GACf,CAAK,CAEL,MAAU,CACPA,EAAAA,MAAI,UAAU,CACb,MAAO,aACP,KAAM,OACN,SAAU,GACd,CAAI,CACD,CACD,CAGD,SAASoB,GAAa,CACrBX,EAAgB,MAAQ,CAACA,EAAgB,KACzC,CAGD,SAASY,GAAiB,CACzBX,EAAoB,MAAQ,CAACA,EAAoB,KACjD,yxBCnLF,GAAG,WAAWY,CAAe"}